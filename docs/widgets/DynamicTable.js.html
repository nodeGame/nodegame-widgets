<!DOCTYPE html>
<html>
<head>
  <title>DynamicTable.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../doc-style.css" />
  <script src="../doc-filelist.js"></script>
  <script>
    var relativeDir = "../";
    var thisFile = "widgets/DynamicTable.js";
    var defaultSidebar = true;
  </script>
  <script src="../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#dynamictable">DynamicTable</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="dynamictable">
  <h1>
    <a href="#dynamictable" name="dynamictable" class="pilcrow"></a>
DynamicTable
  </h1>
</div>
<p>Copyright(c) 2017 Stefano Balietti
MIT Licensed</p>
</div>
<div class="body">
<p>Extends the GameTable widgets by allowing dynamic reshaping</p>
<p>TODO: this widget needs refactoring.</p>
</div>
<div class="details">
<div class="dox_tag_title">See</div>
<div class="dox_tag_detail">
<span class="dox_type">GameTable widget www.nodegame.org</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">node</span>) </span>{
<span class="hljs-meta">
    "use strict"</span>;

    <span class="hljs-keyword">var</span> GameStage = node.GameStage;
    <span class="hljs-keyword">var</span> Table = W.Table;
    <span class="hljs-keyword">var</span> HTMLRenderer = W.HTMLRenderer;

    node.widgets.register(<span class="hljs-string">'DynamicTable'</span>, DynamicTable);

    DynamicTable.prototype = <span class="hljs-keyword">new</span> Table();
    DynamicTable.prototype.constructor = Table;


    DynamicTable.id = <span class="hljs-string">'dynamictable'</span>;
    DynamicTable.version = <span class="hljs-string">'0.3.2'</span>;

    DynamicTable.dependencies = {
        <span class="hljs-attr">Table</span>: {},
        <span class="hljs-attr">JSUS</span>: {},
        <span class="hljs-attr">HTMLRenderer</span>: {}
    };

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DynamicTable</span> (<span class="hljs-params">options, data</span>) </span>{
        Table.call(<span class="hljs-keyword">this</span>, options, data);
        <span class="hljs-keyword">this</span>.options = options;

        <span class="hljs-keyword">this</span>.name = options.name || <span class="hljs-string">'Dynamic Table'</span>;

        <span class="hljs-keyword">this</span>.root = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.bindings = {};
        <span class="hljs-keyword">this</span>.init(<span class="hljs-keyword">this</span>.options);
    }

    DynamicTable.prototype.init = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
        <span class="hljs-keyword">this</span>.options = options;
        <span class="hljs-keyword">this</span>.name = options.name || <span class="hljs-keyword">this</span>.name;
        <span class="hljs-keyword">this</span>.auto_update = (<span class="hljs-string">'undefined'</span> !== <span class="hljs-keyword">typeof</span> options.auto_update) ?
            options.auto_update : <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>.replace = options.replace || <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>.htmlRenderer = <span class="hljs-keyword">new</span> HTMLRenderer({<span class="hljs-attr">renderers</span>: options.renderers});
        <span class="hljs-keyword">this</span>.c(<span class="hljs-string">'state'</span>, GameStage.compare);
        <span class="hljs-keyword">this</span>.setLeft([]);
        <span class="hljs-keyword">this</span>.parse(<span class="hljs-literal">true</span>);
    };

    DynamicTable.prototype.bind = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event, bindings</span>) </span>{
        <span class="hljs-keyword">if</span> (!event || !bindings) <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> that = <span class="hljs-keyword">this</span>;

        node.on(event, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msg</span>) </span>{

            <span class="hljs-keyword">if</span> (bindings.x || bindings.y) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>Cell</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                <span class="hljs-keyword">var</span> func;
                <span class="hljs-keyword">if</span> (that.replace) {
                    func = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x, y</span>) </span>{
                        <span class="hljs-keyword">var</span> found = that.get(x,y);
                        <span class="hljs-keyword">if</span> (found.length !== <span class="hljs-number">0</span>) {
                            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> ci=<span class="hljs-number">0</span>; ci &lt; found.length; ci++) {
                                bindings.cell.call(that, msg, found[ci]);
                            }
                        }
                        <span class="hljs-keyword">else</span> {
                            <span class="hljs-keyword">var</span> cell = bindings.cell.call(
                                that, msg, <span class="hljs-keyword">new</span> Table.Cell({<span class="hljs-attr">x</span>: x, <span class="hljs-attr">y</span>: y}));
                            that.add(cell);
                        }
                    };
                }
                <span class="hljs-keyword">else</span> {
                    func = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x, y</span>) </span>{
                        <span class="hljs-keyword">var</span> cell = bindings.cell.call(
                                that, msg, <span class="hljs-keyword">new</span> Table.Cell({<span class="hljs-attr">x</span>: x, <span class="hljs-attr">y</span>: y}));
                        that.add(cell, x, y);
                    };
                }

                <span class="hljs-keyword">var</span> x = bindings.x.call(that, msg);
                <span class="hljs-keyword">var</span> y = bindings.y.call(that, msg);

                <span class="hljs-keyword">if</span> (x &amp;&amp; y) {

                    x = (x <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span>) ? x : [x];
                    y = (y <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span>) ? y : [y];

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>console.log('Bindings found:');
console.log(x);
console.log(y);</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> xi=<span class="hljs-number">0</span>; xi &lt; x.length; xi++) {
                        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> yi=<span class="hljs-number">0</span>; yi &lt; y.length; yi++) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>Replace or Add</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                            func.call(that, x[xi], y[yi]);
                        }
                    }
                }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>End Cell</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>Header</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">if</span> (bindings.header) {
                <span class="hljs-keyword">var</span> h = bindings.header.call(that, msg);
                h = (h <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span>) ? h : [h];
                that.setHeader(h);
            }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>Left</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">if</span> (bindings.left) {
                <span class="hljs-keyword">var</span> l = bindings.left.call(that, msg);
                <span class="hljs-keyword">if</span> (!J.inArray(l, that.left)) {
                    that.header.push(l);
                }
            }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>Auto Update?</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">if</span> (that.auto_update) {
                that.parse();
            }
        });

    };

    DynamicTable.prototype.append = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">root</span>) </span>{
        <span class="hljs-keyword">this</span>.root = root;
        root.appendChild(<span class="hljs-keyword">this</span>.table);
        <span class="hljs-keyword">return</span> root;
    };

    DynamicTable.prototype.listeners = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{};

})(node);

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
