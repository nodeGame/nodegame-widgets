<!DOCTYPE html>
<html>
<head>
  <title>WaitingRoom.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../doc-style.css" />
  <script src="../doc-filelist.js"></script>
  <script>
    var relativeDir = "../", thisFile = "widgets/WaitingRoom.js", defaultSidebar = true;
  </script>
  <script src="../doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
      <div class="heading h1">
        <a href="#waitingroom">WaitingRoom</a>
      </div>
      <div class="heading h2">
        <a href="#meta-data">Meta-data</a>
      </div>
      <div class="heading h2">
        <a href="#dependencies">Dependencies</a>
      </div>
      <div class="heading h2">
        <a href="#prototype%20properties.">Prototype Properties.</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.sounds">WaitingRoom.sounds</a>
      </div>
      <div class="heading h4">
        <a href="#dispatch">dispatch</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.texts">WaitingRoom.texts</a>
      </div>
      <div class="heading h4">
        <a href="#disconnect">disconnect</a>
      </div>
      <div class="heading h4">
        <a href="#waitedtoolong">waitedTooLong</a>
      </div>
      <div class="heading h4">
        <a href="#notenoughplayers">notEnoughPlayers</a>
      </div>
      <div class="heading h4">
        <a href="#roomclosed">roomClosed</a>
      </div>
      <div class="heading h2">
        <a href="#waitingroom%20constructor">WaitingRoom constructor</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.connected">WaitingRoom.connected</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.poolsize">WaitingRoom.poolSize</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.ngames">WaitingRoom.nGames</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.groupsize">WaitingRoom.groupSize</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.waittime">WaitingRoom.waitTime</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.startdate">WaitingRoom.startDate</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.timeoutid">WaitingRoom.timeoutId</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.playercountdiv">WaitingRoom.playerCountDiv</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.playercount">WaitingRoom.playerCount</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.startdatediv">WaitingRoom.startDateDiv</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.msgdiv">WaitingRoom.msgDiv</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.timerdiv">WaitingRoom.timerDiv</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.timer">WaitingRoom.timer</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.dots">WaitingRoom.dots</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.ontimeout">WaitingRoom.onTimeout</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.disconnectifnotselected">WaitingRoom.disconnectIfNotSelected</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.disconnecttext">WaitingRoom.disconnectText</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.roomclosedtext">WaitingRoom.roomClosedText</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.dispatchsound">WaitingRoom.dispatchSound</a>
      </div>
      <div class="heading h2">
        <a href="#waitingroom%20methods">WaitingRoom methods</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.init">WaitingRoom.init</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.starttimer">WaitingRoom.startTimer</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.cleartimeout">WaitingRoom.clearTimeout</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.updatestate">WaitingRoom.updateState</a>
      </div>
      <div class="heading h3">
        <a href="#waitingroom.updatedisplay">WaitingRoom.updateDisplay</a>
      </div>
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom">
  <h1>
    <a href="#waitingroom" name="waitingroom" class="pilcrow">&#182;</a>
    WaitingRoom
  </h1>
</div>


<p>Copyright(c) 2017 Stefano Balietti <a href="m&#97;&#x69;&#108;&#116;&#x6F;:&#x73;&#x74;&#x65;&#64;&#x6E;&#111;&#x64;&#x65;&#x67;&#97;&#x6D;e&#46;or&#x67;">&#x73;&#x74;&#x65;&#64;&#x6E;&#111;&#x64;&#x65;&#x67;&#97;&#x6D;e&#46;or&#x67;</a>
MIT Licensed</p>
  </div>
  <div class="body"><p>Display the number of connected / required players to start a game</p>

<p>TODO: accepts functions for <code>texts</code> variables, so that they can
integrate current values</p>

<p>www.nodegame.org</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>

    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>

    <span class="nx">node</span><span class="p">.</span><span class="nx">widgets</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s1">&#39;WaitingRoom&#39;</span><span class="p">,</span> <span class="nx">WaitingRoom</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="meta-data">
  <h2>
    <a href="#meta-data" name="meta-data" class="pilcrow">&#182;</a>
    Meta-data
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>

    <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">version</span> <span class="o">=</span> <span class="s1">&#39;1.1.1&#39;</span><span class="p">;</span>
    <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">description</span> <span class="o">=</span> <span class="s1">&#39;Displays a waiting room for clients.&#39;</span><span class="p">;</span>

    <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="s1">&#39;Waiting Room&#39;</span><span class="p">;</span>
    <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">&#39;waitingroom&#39;</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="dependencies">
  <h2>
    <a href="#dependencies" name="dependencies" class="pilcrow">&#182;</a>
    Dependencies
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>

    <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">dependencies</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">JSUS</span><span class="o">:</span> <span class="p">{},</span>
        <span class="nx">VisualTimer</span><span class="o">:</span> <span class="p">{}</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="prototype%20properties.">
  <h2>
    <a href="#prototype%20properties." name="prototype%20properties." class="pilcrow">&#182;</a>
    Prototype Properties.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.sounds">
  <h3>
    <a href="#waitingroom.sounds" name="waitingroom.sounds" class="pilcrow">&#182;</a>
    WaitingRoom.sounds
  </h3>
</div>

  </div>
  <div class="body"><p>Default sounds to play on particular events</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">sounds</span> <span class="o">=</span> <span class="p">{</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="dispatch">
  <h4>
    <a href="#dispatch" name="dispatch" class="pilcrow">&#182;</a>
    dispatch
  </h4>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">dispatch</span><span class="o">:</span> <span class="s1">&#39;/sounds/doorbell.ogg&#39;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.texts">
  <h3>
    <a href="#waitingroom.texts" name="waitingroom.texts" class="pilcrow">&#182;</a>
    WaitingRoom.texts
  </h3>
</div>

  </div>
  <div class="body"><p>Default texts to display</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">texts</span> <span class="o">=</span> <span class="p">{</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="disconnect">
  <h4>
    <a href="#disconnect" name="disconnect" class="pilcrow">&#182;</a>
    disconnect
  </h4>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">disconnect</span><span class="o">:</span> <span class="s1">&#39;&lt;span style=&quot;color: red&quot;&gt;You have been &#39;</span> <span class="o">+</span>
            <span class="s1">&#39;&lt;strong&gt;disconnected&lt;/strong&gt;. Please try again later.&#39;</span> <span class="o">+</span>
            <span class="s1">&#39;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&#39;</span><span class="p">,</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="waitedtoolong">
  <h4>
    <a href="#waitedtoolong" name="waitedtoolong" class="pilcrow">&#182;</a>
    waitedTooLong
  </h4>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">waitedTooLong</span><span class="o">:</span> <span class="s1">&#39;Waiting for too long. Please look &#39;</span> <span class="o">+</span>
            <span class="s1">&#39;for a HIT called &lt;strong&gt;Trouble Ticket&lt;/strong&gt; and file&#39;</span> <span class="o">+</span>
            <span class="s1">&#39; a new trouble ticket reporting your experience.&#39;</span><span class="p">,</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="notenoughplayers">
  <h4>
    <a href="#notenoughplayers" name="notenoughplayers" class="pilcrow">&#182;</a>
    notEnoughPlayers
  </h4>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">notEnoughPlayers</span><span class="o">:</span> <span class="s1">&#39;&lt;h3 align=&quot;center&quot; style=&quot;color: red&quot;&gt;&#39;</span> <span class="o">+</span>
            <span class="s1">&#39;Thank you for your patience.&lt;br&gt;&#39;</span> <span class="o">+</span>
            <span class="s1">&#39;Unfortunately, there are not enough participants in &#39;</span> <span class="o">+</span>
            <span class="s1">&#39;your group to start the experiment.&lt;br&gt;&#39;</span><span class="p">,</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="roomclosed">
  <h4>
    <a href="#roomclosed" name="roomclosed" class="pilcrow">&#182;</a>
    roomClosed
  </h4>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">roomClosed</span><span class="o">:</span> <span class="s1">&#39;&lt;span style=&quot;color: red&quot;&gt; The &#39;</span> <span class="o">+</span>
            <span class="s1">&#39;waiting room is &lt;strong&gt;CLOSED&lt;/strong&gt;. You have been &#39;</span> <span class="o">+</span>
            <span class="s1">&#39;disconnected. Please try again later.&lt;/span&gt;&lt;br&gt;&lt;br&gt;&#39;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom%20constructor">
  <h2>
    <a href="#waitingroom%20constructor" name="waitingroom%20constructor" class="pilcrow">&#182;</a>
    WaitingRoom constructor
  </h2>
</div>

  </div>
  <div class="body"><p>Instantiates a new WaitingRoom object</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">options
</span>
      <span class="dox_type">object</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">WaitingRoom</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.connected">
  <h3>
    <a href="#waitingroom.connected" name="waitingroom.connected" class="pilcrow">&#182;</a>
    WaitingRoom.connected
  </h3>
</div>

  </div>
  <div class="body"><p>Number of players connected</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">connected</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.poolsize">
  <h3>
    <a href="#waitingroom.poolsize" name="waitingroom.poolsize" class="pilcrow">&#182;</a>
    WaitingRoom.poolSize
  </h3>
</div>

  </div>
  <div class="body"><p>Number of players connected before groups are made</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">poolSize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.ngames">
  <h3>
    <a href="#waitingroom.ngames" name="waitingroom.ngames" class="pilcrow">&#182;</a>
    WaitingRoom.nGames
  </h3>
</div>

  </div>
  <div class="body"><p>Total number of games to be dispatched</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">nGames</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.groupsize">
  <h3>
    <a href="#waitingroom.groupsize" name="waitingroom.groupsize" class="pilcrow">&#182;</a>
    WaitingRoom.groupSize
  </h3>
</div>

  </div>
  <div class="body"><p>The size of the group</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">groupSize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.waittime">
  <h3>
    <a href="#waitingroom.waittime" name="waitingroom.waittime" class="pilcrow">&#182;</a>
    WaitingRoom.waitTime
  </h3>
</div>

  </div>
  <div class="body"><p>The time in milliseconds for the timeout to expire</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">waitTime</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.startdate">
  <h3>
    <a href="#waitingroom.startdate" name="waitingroom.startdate" class="pilcrow">&#182;</a>
    WaitingRoom.startDate
  </h3>
</div>

  </div>
  <div class="body"><p>The exact date and time when the game starts</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">startDate</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.timeoutid">
  <h3>
    <a href="#waitingroom.timeoutid" name="waitingroom.timeoutid" class="pilcrow">&#182;</a>
    WaitingRoom.timeoutId
  </h3>
</div>

  </div>
  <div class="body"><p>The id of the timeout, if created</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">timeoutId</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.playercountdiv">
  <h3>
    <a href="#waitingroom.playercountdiv" name="waitingroom.playercountdiv" class="pilcrow">&#182;</a>
    WaitingRoom.playerCountDiv
  </h3>
</div>

  </div>
  <div class="body"><p>Div containing the span for displaying the number of players</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">WaitingRoom.playerCount
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">playerCountDiv</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.playercount">
  <h3>
    <a href="#waitingroom.playercount" name="waitingroom.playercount" class="pilcrow">&#182;</a>
    WaitingRoom.playerCount
  </h3>
</div>

  </div>
  <div class="body"><p>Span displaying the number of connected players</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">playerCount</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.startdatediv">
  <h3>
    <a href="#waitingroom.startdatediv" name="waitingroom.startdatediv" class="pilcrow">&#182;</a>
    WaitingRoom.startDateDiv
  </h3>
</div>

  </div>
  <div class="body"><p>Div containing the start date</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">startDateDiv</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.msgdiv">
  <h3>
    <a href="#waitingroom.msgdiv" name="waitingroom.msgdiv" class="pilcrow">&#182;</a>
    WaitingRoom.msgDiv
  </h3>
</div>

  </div>
  <div class="body"><p>Div containing optional messages to display</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">msgDiv</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.timerdiv">
  <h3>
    <a href="#waitingroom.timerdiv" name="waitingroom.timerdiv" class="pilcrow">&#182;</a>
    WaitingRoom.timerDiv
  </h3>
</div>

  </div>
  <div class="body"><p>Div containing the timer</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">WaitingRoom.timer
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">timerDiv</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.timer">
  <h3>
    <a href="#waitingroom.timer" name="waitingroom.timer" class="pilcrow">&#182;</a>
    WaitingRoom.timer
  </h3>
</div>

  </div>
  <div class="body"><p>VisualTimer instance for max wait time.</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">VisualTimer
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">timer</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.dots">
  <h3>
    <a href="#waitingroom.dots" name="waitingroom.dots" class="pilcrow">&#182;</a>
    WaitingRoom.dots
  </h3>
</div>

  </div>
  <div class="body"><p>Looping dots to give the user the feeling of code execution</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">dots</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.ontimeout">
  <h3>
    <a href="#waitingroom.ontimeout" name="waitingroom.ontimeout" class="pilcrow">&#182;</a>
    WaitingRoom.onTimeout
  </h3>
</div>

  </div>
  <div class="body"><p>Callback to be executed if the timer expires</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">onTimeout</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.disconnectifnotselected">
  <h3>
    <a href="#waitingroom.disconnectifnotselected" name="waitingroom.disconnectifnotselected" class="pilcrow">&#182;</a>
    WaitingRoom.disconnectIfNotSelected
  </h3>
</div>

  </div>
  <div class="body"><p>Flag that indicates whether to disconnect an not selected player</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">disconnectIfNotSelected</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.disconnecttext">
  <h3>
    <a href="#waitingroom.disconnecttext" name="waitingroom.disconnecttext" class="pilcrow">&#182;</a>
    WaitingRoom.disconnectText
  </h3>
</div>

  </div>
  <div class="body"><p>Content of <code>this.bodyDiv.innerHTML</code> when player is disconnected</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">disconnectText</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.roomclosedtext">
  <h3>
    <a href="#waitingroom.roomclosedtext" name="waitingroom.roomclosedtext" class="pilcrow">&#182;</a>
    WaitingRoom.roomClosedText
  </h3>
</div>

  </div>
  <div class="body"><p>Content of <code>this.bodyDiv.innerHTML</code> when player room is closed</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">roomClosedText</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.dispatchsound">
  <h3>
    <a href="#waitingroom.dispatchsound" name="waitingroom.dispatchsound" class="pilcrow">&#182;</a>
    WaitingRoom.dispatchSound
  </h3>
</div>

  </div>
  <div class="body"><p>Flag that indicates that a sound should be played before dispatching</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">WaitingRoom.sounds.dispatch</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">WaitingRoom.alertPlayer
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">dispatchSound</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="waitingroom%20methods">
  <h2>
    <a href="#waitingroom%20methods" name="waitingroom%20methods" class="pilcrow">&#182;</a>
    WaitingRoom methods
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.init">
  <h3>
    <a href="#waitingroom.init" name="waitingroom.init" class="pilcrow">&#182;</a>
    WaitingRoom.init
  </h3>
</div>

  </div>
  <div class="body"><p>Setups the requirements widget</p>

<p>Available options:</p>

<ul>
<li>onComplete: function executed with either failure or success
<ul><li>onTimeout: function executed when timer runs out</li>
<li>onSuccess: function executed when all tests succeed</li>
<li>waitTime: max waiting time to execute all tests (in milliseconds)</li>
<li>startDate: max waiting time to execute all tests (in milliseconds)</li></ul></li>
</ul>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">conf</span>
      <span class="dox_type">object</span>
      <span>Configuration object.</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">conf</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;object&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;WaitingRoom.init: conf must be object. &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;Found: &#39;</span> <span class="o">+</span> <span class="nx">conf</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">conf</span><span class="p">.</span><span class="nx">onTimeout</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;function&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">onTimeout</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;WaitingRoom.init: conf.onTimeout must &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;be function, null or undefined. Found: &#39;</span> <span class="o">+</span>
                                    <span class="nx">conf</span><span class="p">.</span><span class="nx">onTimeout</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">onTimeout</span> <span class="o">=</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">onTimeout</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">conf</span><span class="p">.</span><span class="nx">waitTime</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="kc">null</span> <span class="o">!==</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">waitTime</span> <span class="o">&amp;&amp;</span>
                <span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">waitTime</span><span class="p">)</span> <span class="p">{</span>

                <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;WaitingRoom.init: conf.waitTime &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;must be number, null or undefined. &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;Found: &#39;</span> <span class="o">+</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">waitTime</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">waitTime</span> <span class="o">=</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">waitTime</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">startTimer</span><span class="p">();</span>
        <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34">&#182;</a>
</div>
<p>TODO: check conditions?</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="nx">conf</span><span class="p">.</span><span class="nx">startDate</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">setStartDate</span><span class="p">(</span><span class="nx">conf</span><span class="p">.</span><span class="nx">startDate</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">conf</span><span class="p">.</span><span class="nx">poolSize</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">conf</span><span class="p">.</span><span class="nx">poolSize</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">poolSize</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;WaitingRoom.init: conf.poolSize &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;must be number or undefined. Found: &#39;</span> <span class="o">+</span>
                                    <span class="nx">conf</span><span class="p">.</span><span class="nx">poolSize</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">poolSize</span> <span class="o">=</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">poolSize</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">conf</span><span class="p">.</span><span class="nx">groupSize</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">conf</span><span class="p">.</span><span class="nx">groupSize</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">groupSize</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;WaitingRoom.init: conf.groupSize &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;must be number or undefined. Found: &#39;</span> <span class="o">+</span>
                                    <span class="nx">conf</span><span class="p">.</span><span class="nx">groupSize</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">groupSize</span> <span class="o">=</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">groupSize</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">conf</span><span class="p">.</span><span class="nx">nGames</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">conf</span><span class="p">.</span><span class="nx">nGames</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">nGames</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;WaitingRoom.init: conf.nGames &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;must be number or undefined. Found: &#39;</span> <span class="o">+</span>
                                    <span class="nx">conf</span><span class="p">.</span><span class="nx">nGames</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">nGames</span> <span class="o">=</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">nGames</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">conf</span><span class="p">.</span><span class="nx">connected</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">conf</span><span class="p">.</span><span class="nx">connected</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">connected</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;WaitingRoom.init: conf.connected &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;must be number or undefined. Found: &#39;</span> <span class="o">+</span>
                                    <span class="nx">conf</span><span class="p">.</span><span class="nx">connected</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">connected</span> <span class="o">=</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">connected</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">conf</span><span class="p">.</span><span class="nx">disconnectText</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">disconnectText</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;WaitingRoom.init: conf.&#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;disconnectText must be string or &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;undefined. Found: &#39;</span> <span class="o">+</span>
                                    <span class="nx">conf</span><span class="p">.</span><span class="nx">disconnectText</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">disconnectText</span> <span class="o">=</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">disconnectText</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">disconnectText</span> <span class="o">=</span> <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">texts</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">conf</span><span class="p">.</span><span class="nx">disconnectIfNotSelected</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;boolean&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">disconnectIfNotSelected</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;WaitingRoom.init: &#39;</span> <span class="o">+</span>
                    <span class="s1">&#39;conf.disconnectIfNotSelected must be boolean or &#39;</span> <span class="o">+</span>
                    <span class="s1">&#39;undefined. Found: &#39;</span> <span class="o">+</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">disconnectIfNotSelected</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">disconnectIfNotSelected</span> <span class="o">=</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">disconnectIfNotSelected</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">disconnectIfNotSelected</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">conf</span><span class="p">.</span><span class="nx">dispatchSound</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;boolean&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">dispatchSound</span> <span class="o">&amp;&amp;</span>
                <span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">dispatchSound</span><span class="p">)</span> <span class="p">{</span>

                <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;WaitingRoom.init: &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;conf.dispatchSound must be boolean, &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;string or undefined. Found: &#39;</span> <span class="o">+</span>
                                    <span class="nx">conf</span><span class="p">.</span><span class="nx">dispatchSound</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">dispatchSound</span> <span class="o">=</span> <span class="p">(</span><span class="kc">true</span> <span class="o">===</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">dispatchSound</span><span class="p">)</span> <span class="o">?</span>
                <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">sounds</span><span class="p">.</span><span class="nx">dispatch</span> <span class="o">:</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">dispatchSound</span><span class="p">;</span>
        <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-35" id="section-35">&#182;</a>
</div>
<p>Texts.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>

        <span class="k">if</span> <span class="p">(</span><span class="nx">conf</span><span class="p">.</span><span class="nx">notEnoughPlayersText</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">notEnoughPlayersText</span><span class="p">)</span> <span class="p">{</span>

                <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;WaitingRoom.init: &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;conf.notEnoughPlayersText must be &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;string or undefined. Found: &#39;</span> <span class="o">+</span>
                                    <span class="nx">conf</span><span class="p">.</span><span class="nx">notEnoughPlayersText</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">notEnoughPlayersText</span> <span class="o">=</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">notEnoughPlayersText</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">conf</span><span class="p">.</span><span class="nx">disconnectText</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">disconnectText</span><span class="p">)</span> <span class="p">{</span>

                <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;WaitingRoom.init: &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;conf.disconnectText must be string &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;or undefined. Found: &#39;</span> <span class="o">+</span>
                                    <span class="nx">conf</span><span class="p">.</span><span class="nx">disconnectText</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">disconnectText</span> <span class="o">=</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">disconnectText</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">conf</span><span class="p">.</span><span class="nx">waitedTooLongText</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">waitedTooLongText</span><span class="p">)</span> <span class="p">{</span>

                <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;WaitingRoom.init: &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;conf.waitedTooLongText must be string &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;or undefined. Found: &#39;</span> <span class="o">+</span>
                                    <span class="nx">conf</span><span class="p">.</span><span class="nx">waitedTooLongText</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">waitedTooLongText</span> <span class="o">=</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">waitedTooLongText</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">conf</span><span class="p">.</span><span class="nx">roomClosedText</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">roomClosedText</span><span class="p">)</span> <span class="p">{</span>

                <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;WaitingRoom.init: &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;conf.roomClosedText must be string &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;or undefined. Found: &#39;</span> <span class="o">+</span>
                                    <span class="nx">conf</span><span class="p">.</span><span class="nx">roomClosedText</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">roomClosedText</span> <span class="o">=</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">roomClosedText</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.starttimer">
  <h3>
    <a href="#waitingroom.starttimer" name="waitingroom.starttimer" class="pilcrow">&#182;</a>
    WaitingRoom.startTimer
  </h3>
</div>

  </div>
  <div class="body"><p>Starts a timeout for the max waiting time</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">startTimer</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">waitTime</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">timerDiv</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">timerDiv</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">timerDiv</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s1">&#39;timer-div&#39;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">timerDiv</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span>
            <span class="s1">&#39;Maximum Waiting Time: &#39;</span>
        <span class="p">));</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">timer</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">widgets</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;VisualTimer&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">timerDiv</span><span class="p">,</span> <span class="p">{</span>
            <span class="nx">milliseconds</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">waitTime</span><span class="p">,</span>
            <span class="nx">timeup</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">that</span><span class="p">.</span><span class="nx">bodyDiv</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">that</span><span class="p">.</span><span class="nx">waitedTooLongText</span><span class="p">;</span>
            <span class="p">},</span>
            <span class="nx">update</span><span class="o">:</span> <span class="mi">1000</span>
        <span class="p">});</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-37" id="section-37">&#182;</a>
</div>
<p>Style up: delete title and border;</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="p">.</span><span class="nx">setTitle</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="p">.</span><span class="nx">panelDiv</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">&#39;ng_widget visualtimer&#39;</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-38" id="section-38">&#182;</a>
</div>
<p>Append to bodyDiv.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">bodyDiv</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">timerDiv</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.cleartimeout">
  <h3>
    <a href="#waitingroom.cleartimeout" name="waitingroom.cleartimeout" class="pilcrow">&#182;</a>
    WaitingRoom.clearTimeout
  </h3>
</div>

  </div>
  <div class="body"><p>Clears the timeout for the max execution time of the requirements</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">this.timeoutId</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">this.stillCheckings</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">this.requirements
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">clearTimeout</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">timeoutId</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">clearTimeout</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">timeoutId</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">timeoutId</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.updatestate">
  <h3>
    <a href="#waitingroom.updatestate" name="waitingroom.updatestate" class="pilcrow">&#182;</a>
    WaitingRoom.updateState
  </h3>
</div>

  </div>
  <div class="body"><p>Displays the state of the waiting room on screen</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">WaitingRoom.updateState
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">updateState</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">update</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">update</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;number&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">update</span><span class="p">.</span><span class="nx">connected</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">connected</span> <span class="o">=</span> <span class="nx">update</span><span class="p">.</span><span class="nx">connected</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;number&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">update</span><span class="p">.</span><span class="nx">poolSize</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">poolSize</span> <span class="o">=</span> <span class="nx">update</span><span class="p">.</span><span class="nx">poolSize</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;number&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">update</span><span class="p">.</span><span class="nx">groupSize</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">groupSize</span> <span class="o">=</span> <span class="nx">update</span><span class="p">.</span><span class="nx">groupSize</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitingroom.updatedisplay">
  <h3>
    <a href="#waitingroom.updatedisplay" name="waitingroom.updatedisplay" class="pilcrow">&#182;</a>
    WaitingRoom.updateDisplay
  </h3>
</div>

  </div>
  <div class="body"><p>Displays the state of the waiting room on screen</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">WaitingRoom.updateState
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">updateDisplay</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">numberOfGameSlots</span><span class="p">,</span> <span class="nx">numberOfGames</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">connected</span> <span class="o">&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">poolSize</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">numberOfGames</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">connected</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">groupSize</span><span class="p">);</span>
            <span class="nx">numberOfGames</span> <span class="o">=</span> <span class="nx">numberOfGames</span> <span class="o">&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">nGames</span> <span class="o">?</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">nGames</span> <span class="o">:</span> <span class="nx">numberOfGames</span><span class="p">;</span>
            <span class="nx">numberOfGameSlots</span> <span class="o">=</span> <span class="nx">numberOfGames</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">groupSize</span><span class="p">;</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">playerCount</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">&#39;&lt;span style=&quot;color:red&quot;&gt;&#39;</span> <span class="o">+</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">connected</span> <span class="o">+</span> <span class="s1">&#39;&lt;/span&gt;&#39;</span> <span class="o">+</span> <span class="s1">&#39; / &#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">poolSize</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">playerCountTooHigh</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-42" id="section-42">&#182;</a>
</div>
<p>TODO: make it parametric like other strings.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">this</span><span class="p">.</span><span class="nx">playerCountTooHigh</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">&#39;There are more players in &#39;</span> <span class="o">+</span>
                <span class="s1">&#39;this waiting room than there are playslots in the game. &#39;</span> <span class="o">+</span>
                <span class="s1">&#39;Only &#39;</span> <span class="o">+</span> <span class="nx">numberOfGameSlots</span> <span class="o">+</span> <span class="s1">&#39; players will be selected to &#39;</span> <span class="o">+</span>
                <span class="s1">&#39;play the game.&#39;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">playerCount</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">connected</span> <span class="o">+</span> <span class="s1">&#39; / &#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">poolSize</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">playerCountTooHigh</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">append</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">playerCountDiv</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">playerCountDiv</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s1">&#39;player-count-div&#39;</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">playerCountDiv</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span>
            <span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="s1">&#39;Waiting for All Players to Connect: &#39;</span><span class="p">));</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">playerCount</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">playerCount</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s1">&#39;player-count&#39;</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">playerCountDiv</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">playerCount</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">playerCountTooHigh</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">playerCountTooHigh</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">playerCountDiv</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">playerCountTooHigh</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">dots</span> <span class="o">=</span> <span class="nx">W</span><span class="p">.</span><span class="nx">getLoadingDots</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">playerCountDiv</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dots</span><span class="p">.</span><span class="nx">span</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">bodyDiv</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">playerCountDiv</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">startDateDiv</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">bodyDiv</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">startDateDiv</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">startDateDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">msgDiv</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">bodyDiv</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">msgDiv</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">startDate</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">setStartDate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">startDate</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">waitTime</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">startTimer</span><span class="p">();</span>
        <span class="p">}</span>

    <span class="p">};</span>

    <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">listeners</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">that</span><span class="p">;</span>
        <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

        <span class="nx">node</span><span class="p">.</span><span class="nx">registerSetup</span><span class="p">(</span><span class="s1">&#39;waitroom&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">conf</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">conf</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;object&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">node</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s1">&#39;waiting room widget: invalid setup object: &#39;</span> <span class="o">+</span> <span class="nx">conf</span><span class="p">);</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-43" id="section-43">&#182;</a>
</div>
<p>Configure all requirements.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">that</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nx">conf</span><span class="p">);</span>

            <span class="k">return</span> <span class="nx">conf</span><span class="p">;</span>
        <span class="p">});</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-44" id="section-44">&#182;</a>
</div>
<p>NodeGame Listeners.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">node</span><span class="p">.</span><span class="nx">on</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;PLAYERSCONNECTED&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">msg</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">connected</span> <span class="o">=</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">updateDisplay</span><span class="p">();</span>
        <span class="p">});</span>

        <span class="nx">node</span><span class="p">.</span><span class="nx">on</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;DISPATCH&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">notSelected</span><span class="p">,</span> <span class="nx">reportExitCode</span><span class="p">;</span>
            <span class="nx">msg</span> <span class="o">=</span> <span class="nx">msg</span> <span class="o">||</span> <span class="p">{};</span>
            <span class="nx">data</span> <span class="o">=</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">data</span> <span class="o">||</span> <span class="p">{};</span>

            <span class="nx">reportExitCode</span> <span class="o">=</span> <span class="s1">&#39;&lt;br&gt;You have been disconnected. &#39;</span> <span class="o">+</span>
                <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">data</span><span class="p">.</span><span class="nx">exit</span> <span class="o">?</span>
                 <span class="p">(</span><span class="s1">&#39;Please report this exit code: &#39;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">exit</span><span class="p">)</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span>
                <span class="s1">&#39;&lt;br&gt;&lt;/h3&gt;&#39;</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">action</span> <span class="o">===</span> <span class="s1">&#39;AllPlayersConnected&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">that</span><span class="p">.</span><span class="nx">alertPlayer</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">action</span> <span class="o">===</span> <span class="s1">&#39;NotEnoughPlayers&#39;</span><span class="p">)</span> <span class="p">{</span>

                <span class="nx">that</span><span class="p">.</span><span class="nx">bodyDiv</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">that</span><span class="p">.</span><span class="nx">notEnoughPlayersText</span><span class="p">;</span>

                <span class="k">if</span> <span class="p">(</span><span class="nx">that</span><span class="p">.</span><span class="nx">onTimeout</span><span class="p">)</span> <span class="nx">that</span><span class="p">.</span><span class="nx">onTimeout</span><span class="p">(</span><span class="nx">msg</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>

                <span class="nx">that</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">(</span><span class="nx">that</span><span class="p">.</span><span class="nx">bodyDiv</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">+</span> <span class="nx">reportExitCode</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">action</span> <span class="o">===</span> <span class="s1">&#39;NotSelected&#39;</span><span class="p">)</span> <span class="p">{</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-45" id="section-45">&#182;</a>
</div>
<p>TODO: make all strings parameteric.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">notSelected</span> <span class="o">=</span> <span class="s1">&#39;&lt;h3 align=&quot;center&quot;&gt;&#39;</span> <span class="o">+</span>
                    <span class="s1">&#39;&lt;span style=&quot;color: red&quot;&gt;Unfortunately, you were &#39;</span> <span class="o">+</span>
                    <span class="s1">&#39;&lt;strong&gt;not selected&lt;/strong&gt; to join the game this time&#39;</span><span class="p">;</span>

                <span class="k">if</span> <span class="p">(</span><span class="kc">false</span> <span class="o">===</span> <span class="nx">data</span><span class="p">.</span><span class="nx">shouldDispatchMoreGames</span> <span class="o">||</span>
                    <span class="nx">that</span><span class="p">.</span><span class="nx">disconnectIfNotSelected</span><span class="p">)</span> <span class="p">{</span>

                    <span class="nx">that</span><span class="p">.</span><span class="nx">bodyDiv</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">notSelected</span> <span class="o">+</span> <span class="s1">&#39;. Thank you &#39;</span> <span class="o">+</span>
                        <span class="s1">&#39;for your participation.&lt;/span&gt;&lt;/h3&gt;&lt;br&gt;&lt;br&gt;&#39;</span><span class="p">;</span>

                    <span class="nx">that</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">(</span><span class="nx">that</span><span class="p">.</span><span class="nx">bodyDiv</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">+</span> <span class="nx">reportExitCode</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="nx">that</span><span class="p">.</span><span class="nx">msgDiv</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">notSelected</span> <span class="o">+</span> <span class="s1">&#39;, but you &#39;</span> <span class="o">+</span>
                        <span class="s1">&#39;may join the next one.&lt;/span&gt; &#39;</span> <span class="o">+</span>
                        <span class="s1">&#39;&lt;a class=&quot;hand&quot; onclick=&#39;</span> <span class="o">+</span>
                        <span class="s1">&#39;javascript:this.parentElement.innerHTML=&quot;&quot;&gt;&#39;</span> <span class="o">+</span>
                        <span class="s1">&#39;Ok, I got it.&lt;/a&gt;&lt;/h3&gt;&lt;br&gt;&lt;br&gt;&#39;</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">action</span> <span class="o">===</span> <span class="s1">&#39;Disconnect&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">that</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">(</span><span class="nx">that</span><span class="p">.</span><span class="nx">bodyDiv</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">+</span> <span class="nx">reportExitCode</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">});</span>

        <span class="nx">node</span><span class="p">.</span><span class="nx">on</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;TIME&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">msg</span> <span class="o">=</span> <span class="nx">msg</span> <span class="o">||</span> <span class="p">{};</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;TIME IS UP!&#39;</span><span class="p">);</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">stopTimer</span><span class="p">();</span>
        <span class="p">});</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-46" id="section-46">&#182;</a>
</div>
<p>Start waiting time timer.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">node</span><span class="p">.</span><span class="nx">on</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;WAITTIME&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-47" id="section-47">&#182;</a>
</div>
<p>Avoid running multiple timers.
if (timeCheck) clearInterval(timeCheck);</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>

            <span class="nx">that</span><span class="p">.</span><span class="nx">updateState</span><span class="p">(</span><span class="nx">msg</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">updateDisplay</span><span class="p">();</span>

        <span class="p">});</span>

        <span class="nx">node</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;SOCKET_DISCONNECT&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-48" id="section-48">&#182;</a>
</div>
<p>Terminate countdown.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">that</span><span class="p">.</span><span class="nx">stopTimer</span><span class="p">();</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-49" id="section-49">&#182;</a>
</div>
<p>Write about disconnection in page.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">that</span><span class="p">.</span><span class="nx">bodyDiv</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">that</span><span class="p">.</span><span class="nx">disconnectText</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-50" id="section-50">&#182;</a>
</div>

<div class="highlight"><pre><code>        <span class="c1">// Enough to not display it in case of page refresh.</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Disconnection from server detected!&#39;</span><span class="p">);</span>
        <span class="p">},</span> <span class="mi">200</span><span class="p">);</span>
</code></pre></div>


        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="p">});</span>

        <span class="nx">node</span><span class="p">.</span><span class="nx">on</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;ROOM_CLOSED&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">(</span><span class="nx">that</span><span class="p">.</span><span class="nx">roomClosedText</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">};</span>

    <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setStartDate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">startDate</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">startDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">startDate</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">startDateDiv</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">&#39;Game starts at: &lt;br&gt;&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">startDate</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">startDateDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">stopTimer</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;STOPPING TIMER&#39;</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">disconnect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">disconnectText</span> <span class="o">=</span> <span class="nx">msg</span><span class="p">;</span>
        <span class="nx">node</span><span class="p">.</span><span class="nx">socket</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">stopTimer</span><span class="p">();</span>
    <span class="p">};</span>

    <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">alertPlayer</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">clearBlink</span><span class="p">,</span> <span class="nx">onFrame</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-51" id="section-51">&#182;</a>
</div>
<p>Play sound, if requested.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dispatchSound</span><span class="p">)</span> <span class="nx">JSUS</span><span class="p">.</span><span class="nx">playSound</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dispatchSound</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-52" id="section-52">&#182;</a>
</div>
<p>If document.hasFocus() returns TRUE, then just one repeat is enough.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">hasFocus</span> <span class="o">&amp;&amp;</span> <span class="nb">document</span><span class="p">.</span><span class="nx">hasFocus</span><span class="p">())</span> <span class="p">{</span>
            <span class="nx">JSUS</span><span class="p">.</span><span class="nx">blinkTitle</span><span class="p">(</span><span class="s1">&#39;GAME STARTS!&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">repeatFor</span><span class="o">:</span> <span class="mi">1</span> <span class="p">});</span>
        <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-53" id="section-53">&#182;</a>
</div>
<p>Otherwise we repeat blinking until an event that shows that the
user is active on the page happens, e.g. focus and click. However,
the iframe is not created yet, and even later. if the user clicks it
it won't be detected in the main window, so we need to handle it.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nx">clearBlink</span> <span class="o">=</span> <span class="nx">JSUS</span><span class="p">.</span><span class="nx">blinkTitle</span><span class="p">(</span><span class="s1">&#39;GAME STARTS!&#39;</span><span class="p">,</span> <span class="p">{</span>
                <span class="nx">stopOnFocus</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                <span class="nx">stopOnClick</span><span class="o">:</span> <span class="nb">window</span>
            <span class="p">});</span>
            <span class="nx">onFrame</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">frame</span><span class="p">;</span>
                <span class="nx">clearBlink</span><span class="p">();</span>
                <span class="nx">frame</span> <span class="o">=</span> <span class="nx">W</span><span class="p">.</span><span class="nx">getFrame</span><span class="p">();</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">frame</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">frame</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span> <span class="nx">onFrame</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">};</span>
            <span class="nx">node</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ng</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;FRAME_GENERATED&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">frame</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">frame</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span> <span class="nx">onFrame</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="nx">WaitingRoom</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">destroy</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dots</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">dots</span><span class="p">.</span><span class="nx">stop</span><span class="p">();</span>
        <span class="nx">node</span><span class="p">.</span><span class="nx">deregisterSetup</span><span class="p">(</span><span class="s1">&#39;waitroom&#39;</span><span class="p">);</span>
    <span class="p">};</span>

<span class="p">})(</span><span class="nx">node</span><span class="p">);</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
