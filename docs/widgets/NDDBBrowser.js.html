<!DOCTYPE html>
<html>
<head>
  <title>NDDBBrowser.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../doc-style.css" />
  <script src="../doc-filelist.js"></script>
  <script>
    var relativeDir = "../";
    var thisFile = "widgets/NDDBBrowser.js";
    var defaultSidebar = true;
  </script>
  <script src="../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#nddbbrowser">NDDBBrowser</a>
      </div>

      <div class="heading h2">
        <a href="#defaults">Defaults</a>
      </div>

      <div class="heading h2">
        <a href="#meta-data">Meta-data</a>
      </div>

      <div class="heading h2">
        <a href="#dependencies">Dependencies</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="nddbbrowser">
  <h1>
    <a href="#nddbbrowser" name="nddbbrowser" class="pilcrow"></a>
NDDBBrowser
  </h1>
</div>
<p>Copyright(c) 2017 Stefano Balietti
MIT Licensed</p>
</div>
<div class="body">
<p>Creates an interface to interact with an NDDB database</p>
<p>www.nodegame.org</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">node</span>) </span>{
<span class="hljs-meta">
    "use strict"</span>;

    node.widgets.register(<span class="hljs-string">'NDDBBrowser'</span>, NDDBBrowser);

    <span class="hljs-keyword">var</span> NDDB = node.NDDB,
    TriggerManager = node.TriggerManager;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="defaults">
  <h2>
    <a href="#defaults" name="defaults" class="pilcrow"></a>
Defaults
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
    NDDBBrowser.defaults = {};
    NDDBBrowser.defaults.id = <span class="hljs-string">'nddbbrowser'</span>;
    NDDBBrowser.defaults.fieldset = <span class="hljs-literal">false</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="meta-data">
  <h2>
    <a href="#meta-data" name="meta-data" class="pilcrow"></a>
Meta-data
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
    NDDBBrowser.version = <span class="hljs-string">'0.2.1'</span>;
    NDDBBrowser.description =
        <span class="hljs-string">'Provides a very simple interface to control a NDDB istance.'</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="dependencies">
  <h2>
    <a href="#dependencies" name="dependencies" class="pilcrow"></a>
Dependencies
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
    NDDBBrowser.dependencies = {
        <span class="hljs-attr">JSUS</span>: {},
        <span class="hljs-attr">NDDB</span>: {},
        <span class="hljs-attr">TriggerManager</span>: {}
    };

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">NDDBBrowser</span>(<span class="hljs-params">options</span>) </span>{
        <span class="hljs-keyword">this</span>.options = options;
        <span class="hljs-keyword">this</span>.nddb = <span class="hljs-literal">null</span>;

        <span class="hljs-keyword">this</span>.commandsDiv = <span class="hljs-literal">null</span>;


        <span class="hljs-keyword">this</span>.info = <span class="hljs-literal">null</span>;
    }

    NDDBBrowser.prototype.init = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
        <span class="hljs-keyword">this</span>.tm = <span class="hljs-keyword">new</span> TriggerManager();
        <span class="hljs-keyword">this</span>.tm.init(options.triggers);
        <span class="hljs-keyword">this</span>.nddb = options.nddb || <span class="hljs-keyword">new</span> NDDB({
            <span class="hljs-attr">update</span>: { <span class="hljs-attr">pointer</span>: <span class="hljs-literal">true</span> }
        });
    };

    NDDBBrowser.prototype.append = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.commandsDiv = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'div'</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.id) <span class="hljs-keyword">this</span>.commandsDiv.id = <span class="hljs-keyword">this</span>.id;

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addButtons</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> id = <span class="hljs-keyword">this</span>.id;
            W.addEventButton(id + <span class="hljs-string">'_GO_TO_FIRST'</span>, <span class="hljs-string">'&lt;&lt;'</span>,
                <span class="hljs-keyword">this</span>.commandsDiv, <span class="hljs-string">'go_to_first'</span>);
            W.addEventButton(id + <span class="hljs-string">'_GO_TO_PREVIOUS'</span>, <span class="hljs-string">'&lt;'</span>,
                <span class="hljs-keyword">this</span>.commandsDiv, <span class="hljs-string">'go_to_previous'</span>);
            W.addEventButton(id + <span class="hljs-string">'_GO_TO_NEXT'</span>, <span class="hljs-string">'&gt;'</span>,
                <span class="hljs-keyword">this</span>.commandsDiv, <span class="hljs-string">'go_to_next'</span>);
            W.addEventButton(id + <span class="hljs-string">'_GO_TO_LAST'</span>, <span class="hljs-string">'&gt;&gt;'</span>,
                <span class="hljs-keyword">this</span>.commandsDiv, <span class="hljs-string">'go_to_last'</span>);
            W.addBreak(<span class="hljs-keyword">this</span>.commandsDiv);
        }
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addInfoBar</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> span = <span class="hljs-keyword">this</span>.commandsDiv.appendChild(
                <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'span'</span>));
            <span class="hljs-keyword">return</span> span;
        }

        addButtons.call(<span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">this</span>.info = addInfoBar.call(<span class="hljs-keyword">this</span>);

        <span class="hljs-keyword">this</span>.bodyDiv.appendChild(<span class="hljs-keyword">this</span>.commandsDiv);
    };

    NDDBBrowser.prototype.getRoot = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">root</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.commandsDiv;
    };

    NDDBBrowser.prototype.add = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">o</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.nddb.insert(o);
    };

    NDDBBrowser.prototype.sort = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.nddb.sort(key);
    };

    NDDBBrowser.prototype.addTrigger = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">trigger</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tm.addTrigger(trigger);
    };

    NDDBBrowser.prototype.removeTrigger = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">trigger</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tm.removeTrigger(trigger);
    };

    NDDBBrowser.prototype.resetTriggers = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tm.resetTriggers();
    };

    NDDBBrowser.prototype.listeners = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> that = <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">var</span> id = <span class="hljs-keyword">this</span>.id;

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">notification</span>(<span class="hljs-params">el, text</span>) </span>{
            <span class="hljs-keyword">if</span> (el) {
                node.emit(id + <span class="hljs-string">'_GOT'</span>, el);
                <span class="hljs-keyword">this</span>.writeInfo((<span class="hljs-keyword">this</span>.nddb.nddb_pointer + <span class="hljs-number">1</span>) + <span class="hljs-string">'/'</span> +
                    <span class="hljs-keyword">this</span>.nddb.size());
            }
            <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">this</span>.writeInfo(<span class="hljs-string">'No element found'</span>);
            }
        }

        node.on(id + <span class="hljs-string">'_GO_TO_FIRST'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> el = that.tm.pullTriggers(that.nddb.first());
            notification.call(that, el);
        });

        node.on(id + <span class="hljs-string">'_GO_TO_PREVIOUS'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> el = that.tm.pullTriggers(that.nddb.previous());
            notification.call(that, el);
        });

        node.on(id + <span class="hljs-string">'_GO_TO_NEXT'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> el = that.tm.pullTriggers(that.nddb.next());
            notification.call(that, el);
        });

        node.on(id + <span class="hljs-string">'_GO_TO_LAST'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> el = that.tm.pullTriggers(that.nddb.last());
            notification.call(that, el);

        });
    };

    NDDBBrowser.prototype.writeInfo = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">text</span>) </span>{
        <span class="hljs-keyword">var</span> that;
        that = <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.infoTimeout) clearTimeout(<span class="hljs-keyword">this</span>.infoTimeout);
        <span class="hljs-keyword">this</span>.info.innerHTML = text;
        <span class="hljs-keyword">this</span>.infoTimeout = setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
            that.info.innerHTML = <span class="hljs-string">''</span>;
        }, <span class="hljs-number">2000</span>);
    };

})(node);

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
