<!DOCTYPE html>
<html>
<head>
  <title>EndScreen.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../doc-style.css" />
  <script src="../doc-filelist.js"></script>
  <script>
    var relativeDir = "../", thisFile = "widgets/EndScreen.js", defaultSidebar = true;
  </script>
  <script src="../doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
      <div class="heading h1">
        <a href="#endscreen">EndScreen</a>
      </div>
      <div class="heading h2">
        <a href="#add%20meta-data">Add Meta-data</a>
      </div>
      <div class="heading h2">
        <a href="#dependencies">Dependencies</a>
      </div>
      <div class="heading h2">
        <a href="#endscreen%20constructor">EndScreen constructor</a>
      </div>
      <div class="heading h3">
        <a href="#endscreen.headermessage">EndScreen.headerMessage</a>
      </div>
      <div class="heading h3">
        <a href="#endscreen.message">EndScreen.message</a>
      </div>
      <div class="heading h3">
        <a href="#endscreen.showemailform">EndScreen.showEmailForm</a>
      </div>
      <div class="heading h3">
        <a href="#endscreen.showfeedbackform">EndScreen.showFeedbackForm</a>
      </div>
      <div class="heading h3">
        <a href="#endscreen.showtotalwin">EndScreen.showTotalWin</a>
      </div>
      <div class="heading h3">
        <a href="#endscreen.showexitcode">EndScreen.showExitCode</a>
      </div>
      <div class="heading h3">
        <a href="#endscreen.totalwincurrency">EndScreen.totalWinCurrency</a>
      </div>
      <div class="heading h3">
        <a href="#endscreen.emailform">EndScreen.emailForm</a>
      </div>
      <div class="heading h3">
        <a href="#endscreen.feedback">EndScreen.feedback</a>
      </div>
      <div class="heading h3">
        <a href="#endscreen.endscreenelement">EndScreen.endScreenElement</a>
      </div>
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="endscreen">
  <h1>
    <a href="#endscreen" name="endscreen" class="pilcrow">&#182;</a>
    EndScreen
  </h1>
</div>


<p>Copyright(c) 2017 Stefano Balietti
MIT Licensed</p>
  </div>
  <div class="body"><p>Creates an interface to display final earnings, exit code, etc.</p>

<p>www.nodegame.org</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>

    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">J</span><span class="p">;</span>
    <span class="nx">J</span> <span class="o">=</span> <span class="nx">JSUS</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2">&#182;</a>
</div>
<p>Register the widget in the widgets collection.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">node</span><span class="p">.</span><span class="nx">widgets</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s1">&#39;EndScreen&#39;</span><span class="p">,</span> <span class="nx">EndScreen</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="add%20meta-data">
  <h2>
    <a href="#add%20meta-data" name="add%20meta-data" class="pilcrow">&#182;</a>
    Add Meta-data
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>

    <span class="nx">EndScreen</span><span class="p">.</span><span class="nx">version</span> <span class="o">=</span> <span class="s1">&#39;0.3.0&#39;</span><span class="p">;</span>
    <span class="nx">EndScreen</span><span class="p">.</span><span class="nx">description</span> <span class="o">=</span> <span class="s1">&#39;Game end screen. With end game message, &#39;</span> <span class="o">+</span>
        <span class="s1">&#39;email form, and exit code.&#39;</span><span class="p">;</span>

    <span class="nx">EndScreen</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="s1">&#39;End Screen&#39;</span><span class="p">;</span>
    <span class="nx">EndScreen</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">&#39;end-screen&#39;</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="dependencies">
  <h2>
    <a href="#dependencies" name="dependencies" class="pilcrow">&#182;</a>
    Dependencies
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5">&#182;</a>
</div>
<p>Checked when the widget is created.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">EndScreen</span><span class="p">.</span><span class="nx">dependencies</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">JSUS</span><span class="o">:</span> <span class="p">{},</span>
        <span class="nx">Feedback</span><span class="o">:</span> <span class="p">{},</span>
        <span class="nx">EmailForm</span><span class="o">:</span> <span class="p">{}</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="endscreen%20constructor">
  <h2>
    <a href="#endscreen%20constructor" name="endscreen%20constructor" class="pilcrow">&#182;</a>
    EndScreen constructor
  </h2>
</div>

  </div>
  <div class="body"><p>Creates a new instance of EndScreen</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">options</span>
      <span class="dox_type">object</span>
      <span>Configuration options</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">EndScreen.init
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">EndScreen</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="endscreen.headermessage">
  <h3>
    <a href="#endscreen.headermessage" name="endscreen.headermessage" class="pilcrow">&#182;</a>
    EndScreen.headerMessage
  </h3>
</div>

  </div>
  <div class="body"><p>The header message displayed at the top of the screen</p>

<p>Default: 'Thank you for participating!'</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">headerMessage</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">headerMessage</span> <span class="o">=</span> <span class="s1">&#39;Thank you for participating!&#39;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">headerMessage</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">headerMessage</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">headerMessage</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;EndScreen constructor: &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;options.headerMessage &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;must be string or undefined. &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;Found: &#39;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">headerMessage</span><span class="p">);</span>
        <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="endscreen.message">
  <h3>
    <a href="#endscreen.message" name="endscreen.message" class="pilcrow">&#182;</a>
    EndScreen.message
  </h3>
</div>

  </div>
  <div class="body"><p>The informational message displayed in the body of the screen</p>

<p>Default: 'You have now completed this task and your data
          has been saved. Please go back to the Amazon Mechanical
          Turk web site and submit the HIT.'</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span>  <span class="s1">&#39;You have now completed this task &#39;</span> <span class="o">+</span>
                            <span class="s1">&#39;and your data has been saved. &#39;</span> <span class="o">+</span>
                            <span class="s1">&#39;Please go back to the Amazon Mechanical Turk &#39;</span> <span class="o">+</span>
                            <span class="s1">&#39;web site and &#39;</span> <span class="o">+</span>
                            <span class="s1">&#39;submit the HIT.&#39;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">message</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;EndScreen constructor: options.message &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;must be string or undefined. &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;Found: &#39;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
        <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="endscreen.showemailform">
  <h3>
    <a href="#endscreen.showemailform" name="endscreen.showemailform" class="pilcrow">&#182;</a>
    EndScreen.showEmailForm
  </h3>
</div>

  </div>
  <div class="body"><p>If true, the email form is shown</p>

<p>Default: true</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">showEmailForm</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">showEmailForm</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;boolean&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">showEmailForm</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">showEmailForm</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">showEmailForm</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;EndScreen constructor: &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;options.showEmailForm &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;must be boolean or undefined. &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;Found: &#39;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">showEmailForm</span><span class="p">);</span>
        <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="endscreen.showfeedbackform">
  <h3>
    <a href="#endscreen.showfeedbackform" name="endscreen.showfeedbackform" class="pilcrow">&#182;</a>
    EndScreen.showFeedbackForm
  </h3>
</div>

  </div>
  <div class="body"><p>If true, the feedback form is shown</p>

<p>Default: true</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">showFeedbackForm</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">showFeedbackForm</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;boolean&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">showFeedbackForm</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">showFeedbackForm</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">showFeedbackForm</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;EndScreen constructor: &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;options.showFeedbackForm &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;must be boolean or undefined. &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;Found: &#39;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">showFeedbackForm</span><span class="p">);</span>
        <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="endscreen.showtotalwin">
  <h3>
    <a href="#endscreen.showtotalwin" name="endscreen.showtotalwin" class="pilcrow">&#182;</a>
    EndScreen.showTotalWin
  </h3>
</div>

  </div>
  <div class="body"><p>If true, the total win is shown</p>

<p>Default: true</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">showTotalWin</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">showTotalWin</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;boolean&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">showTotalWin</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">showTotalWin</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">showTotalWin</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;EndScreen constructor: &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;options.showTotalWin &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;must be boolean or undefined. &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;Found: &#39;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">showTotalWin</span><span class="p">);</span>
        <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="endscreen.showexitcode">
  <h3>
    <a href="#endscreen.showexitcode" name="endscreen.showexitcode" class="pilcrow">&#182;</a>
    EndScreen.showExitCode
  </h3>
</div>

  </div>
  <div class="body"><p>If true, the exit code is shown</p>

<p>Default: true</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">showExitCode</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">showExitCode</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;boolean&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">showExitCode</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">showExitCode</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">showExitCode</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;EndScreen constructor: &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;options.showExitCode &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;must be boolean or undefined. &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;Found: &#39;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">showExitCode</span><span class="p">);</span>
        <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="endscreen.totalwincurrency">
  <h3>
    <a href="#endscreen.totalwincurrency" name="endscreen.totalwincurrency" class="pilcrow">&#182;</a>
    EndScreen.totalWinCurrency
  </h3>
</div>

  </div>
  <div class="body"><p>The currency displayed after totalWin</p>

<p>Default: 'USD'</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">totalWinCurrency</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">totalWinCurrency</span> <span class="o">=</span> <span class="s1">&#39;USD&#39;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">totalWinCurrency</span> <span class="o">&amp;&amp;</span>
                 <span class="nx">options</span><span class="p">.</span><span class="nx">totalWinCurrency</span><span class="p">.</span><span class="nx">trim</span><span class="p">()</span> <span class="o">!==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">totalWinCurrency</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">totalWinCurrency</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;EndScreen constructor: &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;options.totalWinCurrency must be undefined &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;or a non-empty string. Found: &#39;</span> <span class="o">+</span>
                                <span class="nx">options</span><span class="p">.</span><span class="nx">totalWinCurrency</span><span class="p">);</span>
        <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="endscreen.emailform">
  <h3>
    <a href="#endscreen.emailform" name="endscreen.emailform" class="pilcrow">&#182;</a>
    EndScreen.emailForm
  </h3>
</div>

  </div>
  <div class="body"><p>EmailForm widget element</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">EmailForm
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">showEmailForm</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">emailForm</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">widgets</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;EmailForm&#39;</span><span class="p">,</span> <span class="nx">J</span><span class="p">.</span><span class="nx">mixin</span><span class="p">({</span>
                <span class="nx">label</span><span class="o">:</span> <span class="s1">&#39;Would you like to be contacted again for future &#39;</span> <span class="o">+</span>
                    <span class="s1">&#39;experiments? If so, leave your email here and &#39;</span> <span class="o">+</span>
                    <span class="s1">&#39;press submit: &#39;</span><span class="p">,</span>
                <span class="nx">onsubmit</span><span class="o">:</span> <span class="p">{</span> <span class="nx">say</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">emailOnly</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">updateUI</span><span class="o">:</span> <span class="kc">true</span> <span class="p">}</span>
            <span class="p">},</span> <span class="nx">options</span><span class="p">.</span><span class="nx">email</span><span class="p">));</span>
        <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="endscreen.feedback">
  <h3>
    <a href="#endscreen.feedback" name="endscreen.feedback" class="pilcrow">&#182;</a>
    EndScreen.feedback
  </h3>
</div>

  </div>
  <div class="body"><p>Feedback widget element</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Feedback
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">showFeedbackForm</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">feedback</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">widgets</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;Feedback&#39;</span><span class="p">,</span> <span class="nx">options</span><span class="p">.</span><span class="nx">feedback</span><span class="p">);</span>
        <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="endscreen.endscreenelement">
  <h3>
    <a href="#endscreen.endscreenelement" name="endscreen.endscreenelement" class="pilcrow">&#182;</a>
    EndScreen.endScreenElement
  </h3>
</div>

  </div>
  <div class="body"><p>Endscreen HTML element</p>

<p>Default: an HTML element,
null initially, element added on append()</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">endScreenHTML</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">init</span><span class="p">();</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17">&#182;</a>
</div>
<p>Implements the Widget.append method.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">EndScreen</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">append</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">endScreenHTML</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">makeEndScreen</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">bodyDiv</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">endScreenHTML</span><span class="p">);</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18">&#182;</a>
</div>
<p>makes the end screen</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">EndScreen</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">makeEndScreen</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">endScreenElement</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">headerElement</span><span class="p">,</span> <span class="nx">messageElement</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">totalWinElement</span><span class="p">,</span> <span class="nx">totalWinParaElement</span><span class="p">,</span> <span class="nx">totalWinInputElement</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">exitCodeElement</span><span class="p">,</span> <span class="nx">exitCodeParaElement</span><span class="p">,</span> <span class="nx">exitCodeInputElement</span><span class="p">;</span>

        <span class="nx">endScreenElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
        <span class="nx">endScreenElement</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">&#39;endscreen&#39;</span><span class="p">;</span>

        <span class="nx">headerElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">);</span>
        <span class="nx">headerElement</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">headerMessage</span><span class="p">;</span>
        <span class="nx">endScreenElement</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">headerElement</span><span class="p">);</span>

        <span class="nx">messageElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">);</span>
        <span class="nx">messageElement</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">message</span><span class="p">;</span>
        <span class="nx">endScreenElement</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">messageElement</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">showTotalWin</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">totalWinElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>

            <span class="nx">totalWinParaElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">);</span>
            <span class="nx">totalWinParaElement</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">&#39;&lt;strong&gt;Your total win:&lt;/strong&gt;&#39;</span><span class="p">;</span>

            <span class="nx">totalWinInputElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">);</span>
            <span class="nx">totalWinInputElement</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">&#39;endscreen-total form-control&#39;</span><span class="p">;</span>
            <span class="nx">totalWinInputElement</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;disabled&#39;</span><span class="p">,</span> <span class="s1">&#39;true&#39;</span><span class="p">);</span>

            <span class="nx">totalWinParaElement</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">totalWinInputElement</span><span class="p">);</span>
            <span class="nx">totalWinElement</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">totalWinParaElement</span><span class="p">);</span>

            <span class="nx">endScreenElement</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">totalWinElement</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">totalWinInputElement</span> <span class="o">=</span> <span class="nx">totalWinInputElement</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">showExitCode</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">exitCodeElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>

            <span class="nx">exitCodeParaElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">);</span>
            <span class="nx">exitCodeParaElement</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">&#39;&lt;strong&gt;Your exit code:&lt;/strong&gt;&#39;</span><span class="p">;</span>

            <span class="nx">exitCodeInputElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">);</span>
            <span class="nx">exitCodeInputElement</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">&#39;endscreen-exit-code &#39;</span> <span class="o">+</span>
                                             <span class="s1">&#39;form-control&#39;</span><span class="p">;</span>
            <span class="nx">exitCodeInputElement</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;disabled&#39;</span><span class="p">,</span> <span class="s1">&#39;true&#39;</span><span class="p">);</span>

            <span class="nx">exitCodeParaElement</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">exitCodeInputElement</span><span class="p">);</span>
            <span class="nx">exitCodeElement</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">exitCodeParaElement</span><span class="p">);</span>

            <span class="nx">endScreenElement</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">exitCodeElement</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">exitCodeInputElement</span> <span class="o">=</span> <span class="nx">exitCodeInputElement</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">showEmailForm</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">node</span><span class="p">.</span><span class="nx">widgets</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">emailForm</span><span class="p">,</span> <span class="nx">endScreenElement</span><span class="p">,</span> <span class="p">{</span>
                <span class="nx">title</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
                <span class="nx">frame</span><span class="o">:</span> <span class="kc">false</span>
            <span class="p">});</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">showFeedbackForm</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">node</span><span class="p">.</span><span class="nx">widgets</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">feedback</span><span class="p">,</span> <span class="nx">endScreenElement</span><span class="p">,</span> <span class="p">{</span>
                <span class="nx">title</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
                <span class="nx">frame</span><span class="o">:</span> <span class="kc">false</span>
            <span class="p">});</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">endScreenElement</span><span class="p">;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19">&#182;</a>
</div>
<p>Implements the Widget.listeners method.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">EndScreen</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">listeners</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">that</span><span class="p">;</span>

        <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20">&#182;</a>
</div>
<p>Listeners added here are automatically removed
when the widget is destroyed.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">node</span><span class="p">.</span><span class="nx">on</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;WIN&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">data</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">preWin</span><span class="p">,</span> <span class="nx">totalWin</span><span class="p">,</span> <span class="nx">exitCode</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">totalHTML</span><span class="p">,</span> <span class="nx">exitCodeHTML</span><span class="p">;</span>

            <span class="nx">data</span> <span class="o">=</span> <span class="nx">message</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
            <span class="nx">exitCode</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">exit</span><span class="p">;</span>

            <span class="nx">totalWin</span> <span class="o">=</span> <span class="nx">J</span><span class="p">.</span><span class="nx">isNumber</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">total</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">totalWin</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">node</span><span class="p">.</span><span class="nx">err</span><span class="p">(</span><span class="s1">&#39;EndScreen error, invalid total win: &#39;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">total</span><span class="p">);</span>
                <span class="nx">totalWin</span> <span class="o">=</span> <span class="s1">&#39;Error: invalid total win.&#39;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">partials</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">J</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">partials</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nx">node</span><span class="p">.</span><span class="nx">err</span><span class="p">(</span><span class="s1">&#39;EndScreen error, invalid partials win: &#39;</span> <span class="o">+</span>
                             <span class="nx">data</span><span class="p">.</span><span class="nx">partials</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="nx">preWin</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">partials</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39; + &#39;</span><span class="p">);</span>

                    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">data</span><span class="p">.</span><span class="nx">totalRaw</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">preWin</span> <span class="o">+=</span> <span class="s1">&#39; = &#39;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">totalRaw</span><span class="p">;</span>
                        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">data</span><span class="p">.</span><span class="nx">exchangeRate</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">preWin</span> <span class="o">+=</span> <span class="s1">&#39;*&#39;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">exchangeRate</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="nx">totalWin</span> <span class="o">=</span> <span class="nx">preWin</span> <span class="o">+</span> <span class="s1">&#39; = &#39;</span> <span class="o">+</span> <span class="nx">totalWin</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">exitCode</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">node</span><span class="p">.</span><span class="nx">err</span><span class="p">(</span><span class="s1">&#39;EndScreen error, invalid exit code: &#39;</span> <span class="o">+</span> <span class="nx">exitCode</span><span class="p">);</span>
                <span class="nx">exitCode</span> <span class="o">=</span> <span class="s1">&#39;Error: invalid exit code.&#39;</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nx">totalHTML</span> <span class="o">=</span> <span class="nx">that</span><span class="p">.</span><span class="nx">totalWinInputElement</span><span class="p">;</span>
            <span class="nx">exitCodeHTML</span> <span class="o">=</span> <span class="nx">that</span><span class="p">.</span><span class="nx">exitCodeInputElement</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">totalHTML</span> <span class="o">&amp;&amp;</span> <span class="nx">that</span><span class="p">.</span><span class="nx">showTotalWin</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">totalHTML</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">totalWin</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">that</span><span class="p">.</span><span class="nx">totalWinCurrency</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">exitCodeHTML</span> <span class="o">&amp;&amp;</span> <span class="nx">that</span><span class="p">.</span><span class="nx">showExitCode</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">exitCodeHTML</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">exitCode</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">});</span>
    <span class="p">};</span>
<span class="p">})(</span><span class="nx">node</span><span class="p">);</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
